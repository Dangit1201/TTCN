<!DOCTYPE html>
<html>
<head>
	<%- include('../layout/head.ejs', {title: "Danh mục sản phẩm" })%>
</head>

<body>
	<%- include('../layout/header.ejs') %>
		
	<!-- /.container-fluid -->
		
	<%- include('../layout/sidebar.ejs') %>
	<!--/.sidebar-->
		
	<div class="col-sm-9 col-sm-offset-3 col-lg-10 col-lg-offset-2 main">			
		<div class="row">
			<ol class="breadcrumb">
				<li><a href="/admin"><svg class="glyph stroked home"><use xlink:href="#stroked-home"></use></svg></a></li>
				<li class="active">Quản lý danh mục</li>
			</ol>
		</div><!--/.row-->
		
		<div class="row">
			<div class="col-lg-12">
				<h1 class="page-header">Quản lý danh mục</h1>
			</div>
		</div><!--/.row-->
		<div id="toolbar" class="btn-group">
            <a href="/admin/categories/create" class="btn btn-success">
                <i class="glyphicon glyphicon-plus"></i> Thêm danh mục
            </a>
        </div>
		<div class="row">
			<div class="col-md-12">
					<div class="panel panel-default">
							<div class="panel-body">
								<table 
									data-toolbar="#toolbar"
									data-toggle="table">
		
									<thead>
									<tr>
										
										<th>Tên danh mục</th>
										<th>Trạng thái</th>
										<th>Hành động</th>
									</tr>
									</thead>
									<tbody>
										<% categories.forEach(function(category){ %>
										
										<tr id="id_<%= category._id%>" class="<%=category.slug%>">
											
											<td><%= category.title%></td>
											<%if(category.status){%>
												<td><span class="label label-success">Hoạt động</span></td>
											<%}else{%>
												<td><span class="label label-danger">Không hoạt động</span></td>
											<%}%>
											<td class="form-group">
												<a href="" class="btn btn-primary"><i class="glyphicon glyphicon-pencil"></i></a>
												<a  href="" class="btn btn-danger" data-id="<%=category.id%>" data-toggle="modal" data-target="#delete-modal-dm"><i class="glyphicon glyphicon-remove" ></i></a>
											</td>
										</tr>
										<%}); %>
									</tbody>
								</table>
							</div>
							<div class="panel-footer">
								<nav aria-label="Page navigation example">
									<!-- <ul class="pagination">
										<li class="page-item"><a class="page-link" href="#">&laquo;</a></li>
										<li class="page-item"><a class="page-link" href="#">1</a></li>
										<li class="page-item"><a class="page-link" href="#">2</a></li>
										<li class="page-item"><a class="page-link" href="#">3</a></li>
										<li class="page-item"><a class="page-link" href="#">&raquo;</a></li>
									</ul> -->
								</nav>
							</div>
						</div>
			</div>
		</div><!--/.row-->
	</div>	<!--/.main-->

	<form name="delete-form-danhmuc" method="post"></form>
	<!-- confirm -->
	<div id="delete-modal-dm"class="modal" tabindex="-1" role="dialog">
		<div class="modal-dialog" role="document">
		  <div class="modal-content">
			<div class="modal-header">
			  <h5 class="modal-title">Xóa danh mục?</h5>
			  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
				<span aria-hidden="true">&times;</span>
			  </button>
			</div>
			<div class="modal-body">
			  <p>Bạn chắc chắn muốn xóa danh mục này?</p>
			</div>
			<div class="modal-footer">
			  
			  <button type="button" class="btn btn-secondary" data-dismiss="modal">Hủy</button>
			  <button  id="btn-delete-form" type="button" class="btn btn-danger">Xóa bỏ</button>
			</div>
		  </div>
		</div>
	  </div>
	  <!--end confirm -->

	<%- include('../layout/footer.ejs')%>
	
	<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
	<script src="https://code.jquery.com/ui/1.12.0/jquery-ui.min.js"></script>
	<script>
	$('tbody').sortable({
			placeholder:"ui-state-hightlight",
			update :function(){
				var ids= $('tbody').sortable('serialize');
				var url="/admin/categories/reorder";
				$.post(url,ids);
			}
	});
	
	</script>
	<script>
		document.addEventListener('DOMContentLoaded',function(){
			$('#delete-modal-dm').on('show.bs.modal', function (event) {
  			var button = $(event.relatedTarget) 
  			ids = button.data('id') 
			
			})
		});
		
		var formdele = document.forms['delete-form-danhmuc'];
		var btndele = document.getElementById('btn-delete-form');
		
		btndele.onclick = function(){
			
			formdele.action='/admin/categories/delete/'+ids;
			formdele.submit();
		}
		
		
	</script>
</body>
<style>
	.ui-state-hightlight{
		border:1px dashed #ccc;
	}
</style>


</html>
